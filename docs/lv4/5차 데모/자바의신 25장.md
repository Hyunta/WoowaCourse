## 쓰레드는 개발자라면 알아두는 것이 좋아요

JVM 이 시작되면 자바 프로세스가 시작한다. 어떤 프로세스든 간에 쓰레드가 하나 이상 수행된다. JVM은 기본적으로 아무런 옵션 없이 실행하면 OS마다 다르지만, 적어도 32MB~64MB의 물리 메모리를 점유한다. 그에 반해서 쓰레드를 하나 추가하면 1MB 이내의 메모리를 점유한다.

자바에서 Thread를 생성하는 방법 크게 두 가지 방법이 있다. 

1. Runnable 인터페이스를 이용한다 
2. Thread 클래스를 이용한다.

Thread 클래스는 Runnable을 구현한 클래스이므로 어떤 것을 적용하느냐의 차이만 있다.

Runnable 인터페이스에는 run() 메서드만 정의되어 있고 리턴값은 없다. 그에 반해 Thread는 많은 생성자와 메서드를 제공한다.

- 쓰레드가 수행되는, 우리가 구현하는 메서드는 run() 메서드다.

- 쓰레드를 시작하는 메서드는 start()이다.

자바에서는 하나의 클래스만 확장할 수 있다. Runnable을 구현하는 경우 다른 클래스로 확장할 수 있지만, Thread를 이용해서 구현하면 다른 클래스로 확장할 수 없다.

여러 쓰레드를 start() 하게되면 순차적으로 진행되지 않는다. 이전 쓰레드의 start()가 끝날 때 까지 기다리지 않고 다음에 있는 쓰레드를 start() 한다.

새로 생성한 쓰레드는 run() 메서드가 종료되면 끝난다. 만약 run()이 끝나지 않으면 실행한 애플리케이션은 끝나지 않는다.

생성자를 통해 Thread의 그룹 아이디를 설정할 수 있다.

### Thread의 메서드

- static sleep()

  매개변수로 넘어온 시간만큼 대기한다

- get/setPriority()

  쓰레드의 우선순위를 정하거나 가져온다. 왠만하면 기본값을 사용하자.

- setDaemon()

  쓰레드가 수행하기 전에 데몬 여부를 지정해야 데몬 쓰레드로 인식된다. 어떤 쓰레드를 데몬으로 지정하면 쓰레드의 수행 여부에 상관없이 JVM이 끝날 수 있다.

데몬 쓰레드를 활용하는 예시는 모니터링이 있다. 주요 쓰레드가 종료되더라도 모니터링 쓰레드가 종료되야 프로세스가 종료할 수 있다. 부가적인 작업을 수행하는 쓰레드를 선언할 때 데몬 쓰레드를 만든다. 주요 쓰레드가 종료되면 데몬 쓰레드는 강제종료된다.



### Synchronized

메서드에 synchronized 키워드를 붙이면, 한번에 한 쓰레드만 해당 메서드에 접근할 수 있다. 하지만 성능이 너무 떨어지므로 메서든 내부에서 synchronized(this or lock) 처럼 객체를 집어넣어 thread-safe가 필요한 상황에서만 걸어주는게 효율적이다.



### 쓰레드를 통제하는 메서드

- join()

  수행중인 쓰레드가 중지할 때까지 대기한다.

- interrupt()

  수행중인 쓰레드를 중지시킨다.



### 추가 공부사항

자바의 쓰레드와 OS의 쓰레드



Process 와 Thread의 차이는 공유자원이다

Process는 집 Thread는 방

OS Thread vs JVM Thread

- JVM Thread는 OS Thread를 가져다 쓰는 것이다. pthread
- java 초기에는 JVM n : OS Thread 1 이라서, jvm에서 1개를 블락하면 os가 블락이되서 사용이 불가능함
- 이제는 jvm : os = 1: 1로 변경했다. 



socket thread 통신

NIO poller vs BIO

- WAS가 안꺼지는 이유는 ServerSocket이 while True를 돌면서 요청을 받아온다. 요청이 오면 Thread를 만들어서 실행시킴



## File

Linux는 모든 것이 File 이다.

User, Kernel 사이를 왔다갔다 하면서 메서드를 통해서 작동한다.

